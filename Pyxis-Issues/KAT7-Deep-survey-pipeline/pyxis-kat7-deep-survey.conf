# This is a Pyxis config file, for running the
# Deep survey observed by the KAT7
# Remove the ms file if it exists

x.sh("rm -rf Deep_field-cal-10s2ch.MS")


info("##### Copy another ms file from the orginal MS data. This will help to preserve the original data whenever we test the pipeline.#####")



x.sh("cp -r Deep_field_2.MS Deep_field-cal-10s2ch.MS")

## default MS -- use this if nothing specified on command line
## commented out in this case, as we always want to specify stuff on the command line,
## or else go with the default list below

#v.MS = "DEEP-SURVEY_ORGINAL_9s2ch0.MS"

v.MS = 'Deep_field-cal-10s2ch.MS'


## default list of measurement sets for e.g. runall()


v.MS_List = ["Deep_field-cal-10s2ch.MS"]


## (i.e. each band is in its own MS, and DDID is always 0)
v.DDID = 0
v.FIELD = 0

## destination directory for plots, images, etc.
DESTDIR_Template = '${OUTDIR>/}plots-${MS:BASE}${-stage<STAGE}'
## base filename for these files
OUTFILE_Template = '${DESTDIR>/}${MS:BASE}${_s<STEP}${_<LABEL}'

## various cal-related options
lsm.PYBDSM_POLARIZED = False     
im.IMAGE_CHANNELIZE = 0         
ms.CHANRANGE = None 
#cal.IFRS = ""

stefcal.STEFCAL_TDLOPTS = "stefcal_verbose=3"



im.IMAGER = imager.IMAGER ='wsclean'

#im.IMAGER = imager.IMAGER ='lwimager'
im.npix = 512
im.cellsize = '30arcsec'
im.stokes = 'I'
#im.mode = 'channel'
im.niter =  5000
im.mode	    = "mfs"
im.weight = 'briggs'
im.gain = .1
im.threshold = 0
im.wprojplanes = 0
im.data ='DATA'
im.robust = 0
COLUMN = "DATA"
TDLCONF = "tdlconf.profiles"

stefcal.STEFCAL_SECTION = "stefcaldE"
stefcal.STEFCAL_SECTION1 = "stefcaldE1"
stefcal.STEFCAL_SECTION2 = "stefcalG"
stefcal.STEFCAL_SECTION3 = "stefcalbeam"

BEAM_PATTERN ='/home/kassaye/BEAM-Calib-Pipeline/Deep-survey-pipeline/kat_beams/KAT7_$$(RL)-chan-304-allfreq-$$(realimag).fits'




#CALSEC = "stefcal"
# If You wish to assign an initial sky model here.
#LSM0 = "Deep-survey_M0-test.lsm.html"


LSMFINAL_Template = "${OUTFILE}.final.lsm.html"
LSM_S1_Template = "${OUTFILE}.s1.lsm.html"
#lsm1=LSM_S1_Template
#LSM_INTRINSIC_Template = "${OUTFILE}_intrinsic.lsm.html"

# The log file for the calibration procedure is available at the given directory. OUTDIR= Givefilename 

v.LOG_Template = "${OUTDIR>/}log-${MS?pyxis:BASE}.log"

## step 1 lsm, created with pybdsm
#LSM1_Template = "${cal.DESTDIR}/${MS:BASE}-test.lsm.html"

## This is a reference LSM from which we transfer dE tags
#LSMREF = "deep4-refmodel.lsm.html"

v.LOG_Template = "${OUTDIR>/}log-${MS?pyxis:BASE}.log"



